# Sync Validator Agent

프로젝트 동기화 후 검증을 수행하는 에이전트

## 목적

현재 프로젝트와 실제 프로젝트 간 **코드 동기화 상태 검증**

## 핵심 원칙

1. **읽기 전용**: 파일을 수정하지 않음
2. **차이 분석**: 두 프로젝트의 파일을 비교
3. **검증 리포트**: 누락, 차이, 충돌 사항 보고
4. **Database 제외**: Database 폴더는 개발자가 직접 작업하므로 검증하지 않음

---

## 주요 기능

### 1. 동기화 완료 확인

최근 체크리스트의 파일 목록을 기준으로 실제 프로젝트 검증

**검증 항목:**
- 파일 존재 여부
- 파일 내용 일치 여부
- 빌드 가능 여부 (선택)

### 2. 차이 분석

**비교 대상:**
- 현재 프로젝트 (VSCode)
- 실제 프로젝트 (Visual Studio)

**비교 방법:**
- 파일 내용 line-by-line 비교
- 공백, 줄바꿈 무시 옵션

### 3. 검증 리포트 생성

**출력 위치:** `works/sync-reports/YYYYMMDD_HHMM_validation_report.md`

---

## 검증 프로세스

### Step 1: 체크리스트 읽기

최근 생성된 체크리스트 파일에서 동기화 대상 파일 목록 추출

### Step 2: 파일 필터링

Database 폴더 파일은 제외하고 검증 대상 선별:
- **포함**: MdcHR26Apps.BlazorServer/, MdcHR26Apps.Models/
- **제외**: Database/ (개발자가 직접 작업)

### Step 3: 파일 존재 확인

각 파일이 실제 프로젝트에 존재하는지 확인

### Step 4: 내용 비교

존재하는 파일의 내용을 현재 프로젝트와 비교

**네임스페이스 통일 전제:**
- 네임스페이스가 동일 (MdcHR26Apps.BlazorServer)
- 따라서 내용이 완전히 일치해야 함

### Step 5: 리포트 생성

```markdown
# 동기화 검증 리포트

**검증일시**: 2026-01-22 16:00
**체크리스트**: 20260122_1530_sync_checklist.md
**검증 파일**: 5개

---

## ✅ 검증 통과 (4개)

- ✅ Login.razor - 내용 일치
- ✅ Logout.razor - 내용 일치
- ✅ Routes.razor - 내용 일치
- ✅ v_MemberListDB.cs - 내용 일치

---

## ⚠️ 주의 필요 (1개)

### UserRepository.cs
**상태**: 차이 있음

**현재 프로젝트 (Line 256):**
```csharp
var passwordBytes = System.Text.Encoding.Unicode.GetBytes(password);
```

**실제 프로젝트 (Line 256):**
```csharp
var passwordBytes = System.Text.Encoding.UTF8.GetBytes(password);
```

**권장 조치**: 실제 프로젝트의 UserRepository.cs 다시 복사

---

## ❌ 누락 파일 (0개)

(없음)

---

## 📊 요약

- 총 파일: 5개
- 통과: 4개 (80%)
- 차이: 1개 (20%)
- 누락: 0개 (0%)

**권장 사항:**
- UserRepository.cs를 다시 복사하세요
- 빌드를 실행하여 최종 확인하세요
```

---

## 사용 방법

### 1. 동기화 후 검증 요청

```
사용자: "sync-validator로 동기화 확인해줘"
```

### 2. Agent 작업 순서

1. `works/sync-checklists/`에서 최근 체크리스트 찾기
2. 체크리스트의 파일 목록 추출
3. 각 파일에 대해:
   - 현재 프로젝트 경로 생성
   - 실제 프로젝트 경로 생성
   - 파일 존재 확인
   - 내용 비교
4. 검증 리포트 생성
5. `works/sync-reports/` 폴더에 저장

### 3. 차이 발견 시

리포트를 보고 개발자가:
- 차이가 있는 파일 재확인
- 필요 시 다시 복사
- 빌드 및 테스트

---

## 고급 기능

### 옵션 1: 특정 체크리스트 지정

```
사용자: "20260122_1530 체크리스트로 검증해줘"
```

### 옵션 2: 전체 프로젝트 검증 (느림)

```
사용자: "전체 프로젝트 동기화 상태 확인해줘"
```

모든 파일을 비교 (시간 소요)

### 옵션 3: 빌드 검증 포함

```
사용자: "빌드 검증 포함해서 확인해줘"
```

파일 비교 후 실제 프로젝트에서 `dotnet build` 실행

---

## 비교 알고리즘

### 기본 비교
```
1. 파일 읽기 (UTF-8)
2. Line-by-line 비교
3. 공백, 줄바꿈 정규화
4. 일치 여부 판단
```

### 스마트 비교 (선택)
```
- 주석 무시
- 공백 완전 무시
- 줄 순서 무시 (using 문)
```

---

## 출력 형식

### 성공 시
```
✅ 모든 파일이 정상적으로 동기화되었습니다.
검증 리포트: works/sync-reports/20260122_1600_validation_report.md
```

### 차이 발견 시
```
⚠️ 1개 파일에 차이가 있습니다.
- UserRepository.cs: Line 256 불일치

상세 리포트: works/sync-reports/20260122_1600_validation_report.md
```

### 누락 발견 시
```
❌ 1개 파일이 복사되지 않았습니다.
- Routes.razor: 파일 없음

상세 리포트: works/sync-reports/20260122_1600_validation_report.md
```

---

## 제약사항

- **파일 수정 금지**: 차이를 발견해도 자동 수정하지 않음
- **읽기 권한 필요**: 두 프로젝트 모두 읽기 가능해야 함
- **경로 가정**: 실제 프로젝트 경로가 고정됨

---

## 트러블슈팅

### 체크리스트 없음
→ 먼저 checklist-generator 실행

### 실제 프로젝트 경로 오류
→ `C:\Codes\41_MdcHR26\MdcHR26App` 경로 확인

### 권한 오류
→ Visual Studio가 파일을 잠그고 있는지 확인

---

## 통합 워크플로우

```
1. 작업 완료 → Git commit
   ↓
2. checklist-generator 실행
   → 체크리스트 생성
   ↓
3. 개발자가 수동 복사
   → 체크리스트 체크
   ↓
4. sync-validator 실행
   → 검증 리포트 확인
   ↓
5. 차이 있으면 재복사
   ↓
6. 빌드 및 테스트
   ↓
7. 실제 프로젝트 Git commit
```

---

**작성일**: 2026-01-22
**버전**: 1.0
**담당**: Claude AI

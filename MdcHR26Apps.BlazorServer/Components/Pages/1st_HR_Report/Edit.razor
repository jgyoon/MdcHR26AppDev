@page "/1st_hr_report/ReportEdit/{Id:long}"

<PageTitle>평가 작성</PageTitle>

<h3>평가 작성</h3>

@if (model == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <div class="row">
        <div class="col-md-12">
            <EditForm Model="model">
                @*평가 기본정보*@
                <FormSelectList Label="평가지표" BindValue="@model.Report_Item_Name_1" IsDisabled="true" />
                <FormSelectList Label="평가직무" BindValue="@model.Report_Item_Name_2" IsDisabled="true" />
                <FormSelectNumber Label="평가비중" BindValue="@model.Report_Item_Proportion" IsDisabled="true" />
                <FormSelectList Label="세부평가직무" BindValue="@model.Report_SubItem_Name" IsDisabled="true" />
                <FormSelectNumber Label="세부평가비중" BindValue="@model.Report_SubItem_Proportion" IsDisabled="true" />
                <hr />

                @*Todolist 세부업무리스트*@
                <div class="card">
                    <div class="card-header">
                        @if (!TaskCollapsed)
                        {
                            <h5>
                                세부업무 리스트(@taskCount 개)
                                <span @onclick="@TaskToggle" class="oi oi-plus mr-1" />
                                <span id="Calculate_User_Evaluation" class="btn btn-secondary" @onclick="(() => CalculateAction())">계산하기</span>
                            </h5>
                        }
                        else
                        {
                            <h5>
                                세부업무 리스트(@taskCount 개)
                                <span @onclick="@TaskToggle" class="oi oi-minus mr-1" />
                                <span id="Calculate_User_Evaluation" class="btn btn-secondary" @onclick="(() => CalculateAction())">계산하기</span>
                            </h5>

                        }
                    </div>
                    <div class="card-body">
                        @if (tasklist.Count == 0)
                        {
                            <h5>세부업무가 없습니다.</h5>
                        }
                        else
                        {
                            @if (TaskCollapsed)
                            {
                                @*Card*@
                                <div class="row">
                                    @foreach (var item in tasklist)
                                    {
                                        <FormTaskItem task="item" />
                                    }
                                </div>
                            }
                        }
                    </div>
                </div>
                <hr />
                @*평가대상자 작성정보*@
                @*일정준수*@
                <label for="User_Evaluation_1" class="form-label mb-1">일정준수(0.5~100) : @Calculate_User_Evaluation_1_Value.ToString() / 100</label>
                <div class="input-group mb-1">
                    <span class="input-group-text mb-1" style="width: 8em;">일정준수</span>
                    <InputNumber class="form-control mb-1" id="User_Evaluation_1" step="0.5" min="0" max="100" @bind-Value=@Calculate_User_Evaluation_1_Value disabled></InputNumber>
                    <span class="input-group-text mb-1">점</span>
                </div>
                @*업무수행도*@
                <label for="User_Evaluation_2" class="form-label mb-1">업무수행도(0.5~100) : @Calculate_User_Evaluation_2_Value.ToString() / 100</label>
                <div class="input-group mb-1">
                    <span class="input-group-text mb-1" style="width: 8em;">업무수행도</span>
                    <InputNumber class="form-control mb-1" id="User_Evaluation_2" step="0.5" min="0" max="100" @bind-Value=@Calculate_User_Evaluation_2_Value disabled></InputNumber>
                    <span class="input-group-text mb-1">점</span>
                </div>
                @*결과물*@
                <label for="User_Evaluation_3" class="form-label mb-1">결과평가(정성평가/0.5~100) : @model.User_Evaluation_3.ToString() / 100</label>
                <div class="input-group mb-1">
                    <span class="input-group-text mb-1" style="width: 8em;">결과평가</span>
                    <InputNumber class="form-control mb-1" id="User_Evaluation_3" step="0.5" min="0" max="100" @bind-Value=@model.User_Evaluation_3></InputNumber>
                    <span class="input-group-text mb-1">점</span>
                </div>
                <div class="input-group mb-1">
                    <input id="User_Evaluation_3" type="range" class="form-control-range input-group mb-1" step="0.5" min="0" max="100" @bind-value=@model.User_Evaluation_3>
                </div>
                @*평가의견*@
                @if (String.IsNullOrEmpty(model.User_Evaluation_4))
                {
                    <label for="User_Comment" class="form-label mb-1"> 비고(1000자 이내로 작성) : 0 / 1000</label>
                }
                else if (model.User_Evaluation_4.Length > 1000)
                {
                    <label for="User_Comment" class="form-label mb-1" style="color:red;">비고(1000자 이내로 작성) : @model.User_Evaluation_4.Length.ToString() / 1000</label>
                }
                else
                {
                    <label for="User_Comment" class="form-label mb-1">비고(1000자 이내로 작성) : @model.User_Evaluation_4.Length.ToString() / 1000</label>
                }
                <div class="input-group mb-1">
                    <span class="input-group-text mb-1" style="width: 8em;">비고</span>
                    <InputTextArea id="User_Comment" class="form-control mb-1" rows="5" @bind-Value="@model.User_Evaluation_4">
                    </InputTextArea>
                </div>
                <hr />
                <div class="input-group mb-1">
                    <button type="button" id="editbutton" class="btn btn-primary" @onclick="EditReport">변경</button>
                    <button type="button" id="movepageutton" class="btn btn-light" @onclick="MoveReportMainPage">목록</button>
                </div>
            </EditForm>
        </div>
    </div>
}

@if (!String.IsNullOrEmpty(resultText))
{
    <div>
        <p>@resultText</p>
    </div>
}